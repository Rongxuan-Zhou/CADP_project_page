<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Constraint-Aware Diffusion Policy for Safe Robotic Manipulation</title>
    <meta name="description" content="Constraint-Aware Diffusion Policy (CADP): bridging learning-based generation with guaranteed-safe execution. ICRA 2026." />
    <meta property="og:title" content="Constraint-Aware Diffusion Policy for Safe Robotic Manipulation" />
    <meta property="og:description" content="CADP: bridging learning-based generation with guaranteed-safe execution. ICRA 2026." />
    <meta property="og:type" content="website" />
    <meta property="og:image" content="fig1.png" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="assets/css/main.css" />
    <link rel="icon" href="fig1.png" />
  </head>
  <body>
    <header class="site-header">
      <div class="container">
        <h1 class="project-title">
          <span class="line">Constraint-Aware Diffusion Policy for Safe Robotic Manipulation:</span>
          <span class="line">Bridging Learning-based Generation with Guaranteed-Safe Execution</span>
        </h1>
        <p class="project-subtitle">ICRA 2026</p>

        <div class="authors">
          <span class="author">Rongxuan Zhou</span>
          <span class="sep">·</span>
          <span class="author">Xiao Hu</span>
          <span class="sep">·</span>
          <span class="author">Yang Ye</span>
        </div>

        <div class="affiliations">
          <span class="affil">Northeastern University, Boston, USA</span>
        </div>

        <div class="cta-row">
          <a class="btn primary" href="ICRA26_RX.pdf" target="_blank" rel="noopener">Paper PDF</a>
          <a class="btn" href="#bibtex">BibTeX</a>
          <a class="btn" href="#video">Video</a>
          <a class="btn" href="#code">Code</a>
          <a class="btn" href="#poster">Poster</a>
        </div>
      </div>
    </header>

    <main>
      <section class="teaser">
        <div class="container">
          <img class="img-narrow" src="fig1.png" alt="Fig. 1: CADP framework overview" />
          <p class="caption"><strong>Fig. 1:</strong> The CADP framework overview. This figure contains three panels: (a) A 3D visualization showing unsafe trajectories generated by standard diffusion models violating multiple constraints (collisions, joint limits, velocity violations). (b) The tightly-coupled CADP architecture diagram shows bidirectional information flow between components. (c) Comparison of trajectory distributions in configuration space — standard diffusion (scattered, unsafe) vs CADP (concentrated in safe regions).</p>
        </div>
      </section>

      <section id="abstract">
        <div class="container narrow">
          <h2>Abstract</h2>
          <p>
            Diffusion models have demonstrated remarkable capability in learning complex robotic manipulation behaviors from demonstrations, capturing the inherent multimodality of manipulation tasks. However, these models fundamentally lack constraint awareness, generating trajectories that may violate physical limits, cause collisions, or exhibit unsafe dynamics. This paper presents the Constraint-Aware Diffusion Policy (CADP), a comprehensive integrative framework that addresses the critical safety gap in learning-based manipulation through a tightly-coupled multi-layered architecture. CADP introduces three coupled safety-assurance mechanisms: (1) shared key configuration encoding, (2) Control Barrier Function (CBF)-informed diffusion training, and (3) unified sliding mode control for verifiable control optimization. Additionally, we achieve a 546-fold speedup in safety verification through batch-optimized control barrier functions, enabling real-time operation at 100 Hz. Our CBF-informed training demonstrates 2.6× gradient amplification in critical safety regions, significantly enhancing constraint-aware learning. With extensive experimental validations, CADP achieves 96.4% task success rate with 100% safety guarantee across 500 trials in challenging scenarios and outperforms existing methods.
          </p>
          <ul class="bullets">
            <li>Three coupled safety mechanisms: shared key configuration, CBF-informed training, unified sliding mode control.</li>
            <li>546× speedup in safety verification; real-time operation at 100 Hz.</li>
            <li>96.4% success with 100% safety across 500 trials.</li>
          </ul>
        </div>
      </section>

      

      <section id="method">
        <div class="container narrow">
          <h2>Method</h2>
          <h3>Tightly-Coupled CADP Architecture</h3>
          <p>
            The core innovation of CADP is tight architectural coupling across components, forming a unified system with bidirectional information flow (Fig. 2). Rather than isolated modules, explicit connections propagate safety signals across all stages.
          </p>
          <figure>
            <img src="fig2.png" alt="Fig. 2: Detailed CADP architecture" />
            <figcaption><strong>Fig. 2:</strong> Detailed CADP architecture with coupling mechanisms. This comprehensive diagram shows: (a) Three coupling mechanisms with bidirectional information flow paths highlighted in different colors. (b) Shared key configuration encoding propagating through all stages. (c) CBF-informed gradient flow during training creates stronger signals near constraints. (d) Unified sliding manifold combining CLF and CBF objectives.</figcaption>
          </figure>

          <h3>Coupling Mechanism 1: Shared Key Configuration Encoding</h3>
          <p>
            Key configurations {q̄k} capture critical states near constraints and are maintained as a shared encoding through training, inference, and control. Selection uses a weighted scoring:
          </p>
          <ul class="bullets">
            <li>S1(q): proximity via SDF — exp(−SDF(q)/σprox)</li>
            <li>S2(q): diversity — distance to selected key set</li>
            <li>S3(q): demonstration support — frequency along demos</li>
          </ul>
          <p>
            These encodings condition the diffusion model and guide control as waypoints, condensing configuration distributions and improving trajectory quality (Fig. 3).
          </p>
          <figure>
            <img src="fig3.png" alt="Fig. 3: Key configuration selection and impact" />
            <figcaption><strong>Fig. 3:</strong> Key configuration selection and impact. (a) Heatmap showing configuration density before and after key configuration conditioning. (b) Trajectory quality metrics with and without key configurations.</figcaption>
          </figure>

          <h3>Coupling Mechanism 2: CBF‑Informed Diffusion Training</h3>
          <p>
            Barrier values B(q) from collision, joint, and velocity constraints modulate the denoising objective with spatially adaptive weights. Exponential weighting e<sup>−B/γ</sup> strengthens gradients near boundaries, yielding ≈2.6× gradient amplification in critical regions and faster convergence to safe behaviors (Fig. 4).
          </p>
          <figure>
            <img src="fig4.png" alt="Fig. 4: CBF-informed gradient analysis" />
            <figcaption><strong>Fig. 4:</strong> CBF-informed gradient analysis demonstrating 2.6× amplification in critical regions. (a) 3D surface plot showing gradient magnitude as a function of distance to constraint and training epoch, with peak amplification near boundaries. (b) Vector field visualization of gradient flow near obstacles, highlighting stronger corrective signals. (c) Histogram comparing gradient distributions for standard vs CBF-informed training, showing significant shift toward higher gradients (2.6× in danger zones). (d) Learning curves showing faster convergence to safe behaviors with CBF-informed loss.</figcaption>
          </figure>

          <h3>Coupling Mechanism 3: Unified Sliding Mode Control</h3>
          <p>
            Execution unifies CLF (tracking) and CBF (safety) on a single sliding manifold s(x,t) = V(x,t) + βB(x) − c. Parameters (β, c) adapt to the learned trajectory distribution, and the control law u = −[L<sub>g</sub>s]<sup>−1</sup>(L<sub>f</sub>s − K·sat(s/Φ)) avoids QP infeasibility while balancing safety and performance (Fig. 5).
          </p>
          <figure class="figure-narrow">
            <img src="fig5.png" alt="Fig. 5: Sliding mode control performance" />
            <figcaption><strong>Fig. 5:</strong> Sliding mode control performance. Phase portrait showing trajectories converging to sliding manifold from various initial conditions.</figcaption>
          </figure>

          <h3>Batch‑Optimized Safety Verification</h3>
          <p>
            Vectorized barrier computations, parallel violation detection, and batched QP projection enable real‑time verification with a 546× speedup, including dynamic feasibility via time‑scaling when needed (Algorithm 1).
          </p>

          <h3>Theoretical Guarantees</h3>
          <ul class="bullets">
            <li>Finite‑time convergence to the manifold: t<sub>s</sub> ≤ |s(x₀)|/(K − d<sub>max</sub>).</li>
            <li>Safety invariance: B(x(t)) ≥ 0 for t ≥ t<sub>s</sub>.</li>
            <li>Exponential tracking: ∥e(t)∥ ≤ ∥e(t<sub>s</sub>)∥e<sup>−λ(t−t<sub>s</sub>)</sup>.</li>
            <li>Robustness under bounded disturbances ∥d∥ ≤ d<sub>max</sub>.</li>
          </ul>
          
        </div>
      </section>

      <section id="evaluation">
        <div class="container">
          <h2>Evaluation</h2>
          <p>
            We compare CADP against representative approaches across N = 500 trials: PRESTO (physics-regularized training with trajectory optimization), CoDiG (CBF-guided diffusion sampling), and CLF-CBF-QP (traditional optimization-based control). Metrics include success rate, safety rate, inference time, and tracking error. CADP achieves a 96.4% task success rate with 100% safety guarantees, while maintaining real-time performance.
          </p>
          <figure>
            <img src="fig6.png" alt="Fig. 6: Comprehensive performance comparison" />
            <figcaption><strong>Fig. 6:</strong> Comprehensive performance comparison across methods. (a) Success rate, safety rate, and efficiency for each method. (b) Tracking error distributions with quartiles and outliers. (c) Pareto frontier showing the trade-off between task performance and safety guarantee, with CADP dominating the frontier.
            </figcaption>
          </figure>
          <p>
            Beyond aggregate metrics, CADP demonstrates robust behavior in challenging scenarios: in cluttered scenes it maintains safety margins; in narrow passages it avoids the infeasibility that causes CLF-CBF-QP to freeze; and with dynamic obstacles it re-verifies and re-plans online, maintaining safety with sub-5 ms updates and 94% success in dynamic avoidance. CADP also generalizes to novel obstacles with strong success rates.
          </p>
          <figure>
            <img src="fig7.png" alt="Fig. 7: Validation across challenging scenarios" />
            <figcaption><strong>Fig. 7:</strong> (a) Cluttered environment with 10 obstacles: trajectory color-coded by safety margin successfully navigates. (b) Distance to nearest obstacle stays above safety boundary. (c) Narrow passage: CADP passes smoothly while CLF-CBF-QP freezes due to optimization infeasibility. (d) Dynamic obstacle: CADP re-plans in real time to avoid the predicted motion. Together these results demonstrate robustness and safety in complex static, constrained, and dynamic environments.
            </figcaption>
          </figure>
        </div>
      </section>

      

      <section id="bibtex">
        <div class="container narrow">
          <h2>Citation</h2>
          <p>If you find this work useful, please cite:</p>
          <pre><code>@inproceedings{zhou2026cadp,
  title     = {Constraint-Aware Diffusion Policy for Safe Robotic Manipulation: Bridging Learning-based Generation with Guaranteed-Safe Execution},
  author    = {Zhou, Rongxuan and Hu, Xiao and Ye, Yang},
  booktitle = {IEEE International Conference on Robotics and Automation (ICRA)},
  year      = {2026}
}</code></pre>
        </div>
      </section>
    </main>

    <footer class="site-footer">
      <div class="container">
      </div>
    </footer>
  </body>
  </html>
